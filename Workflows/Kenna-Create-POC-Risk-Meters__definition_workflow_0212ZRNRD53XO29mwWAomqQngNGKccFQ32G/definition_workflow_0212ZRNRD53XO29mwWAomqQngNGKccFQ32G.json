{
  "workflow": {
    "unique_name": "definition_workflow_0212ZRNRD53XO29mwWAomqQngNGKccFQ32G",
    "name": "Kenna - Create POC Risk Meters",
    "title": "Kenna - Create POC Risk Meters",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "input",
          "name": "Kenna API Token",
          "type": "datatype.string",
          "description": "Kenna API Token",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_0212ZUIZIRYWE78STEODVLdBO7jORSN6svc",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_0219CKPYO1XYU0C4W6FJS4GmjI2w3X8fYQW",
        "properties": {
          "value": [
            {
              "column_data": {
                "RM_Name": "Kenna High - CVSS Score Low",
                "RM_Search_String": "vulnerability_score:\u003e=80 AND cvss_v2_score:\u003e0 AND cvss_v2_score:\u003c=6"
              }
            },
            {
              "column_data": {
                "RM_Name": "Kenna High - Scanner Low",
                "RM_Search_String": "vulnerability_score:\u003e=80 AND scanner_score:\u003c=6"
              }
            },
            {
              "column_data": {
                "RM_Name": "Kenna Low - CVSS Score High",
                "RM_Search_String": "vulnerability_score:\u003c50 AND cvss_v2_score:\u003e6"
              }
            },
            {
              "column_data": {
                "RM_Name": "Kenna Low - Scanner High",
                "RM_Search_String": "vulnerability_score:\u003c50 AND scanner_score:\u003e6"
              }
            }
          ],
          "scope": "local",
          "name": "Kenna RM Table",
          "type": "datatype.table",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_0219CLA2359V16lldItAk8daiPPsrXthJXN",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This workflow creates a set of Kenna Risk Meter groups based on Risk Meter Names and Search Queries stored in the local \"Kenna RM Table\".\n\nTarget Group: not required \nTargets: create a Target (HTTP Endpoint) with your API base URL\n\nSteps:\n[] Select your Target\n[] Adjust the local Kenna RM Table as needed before running this workflow\n[] Run the workflow \n[] Enter required input for workflow execution (API token)\n[] Workflow is looping through the Kenn RM Table\n[] Creating a new Risk Meter for each row in table with RISKMETERNAME and RISKMETERSEARCH\n",
      "display_name": "Kenna - Create POC Risk Meters",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "target_type": "web-service.endpoint",
        "target_id": "definition_target_021A12HNH7QZ16uAiIvGO6FIZl16xDL2nbi",
        "execute_on_workflow_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_0212ZX1LO33T22jMb5RuczKHoCXlNbQud6D",
        "name": "For Each",
        "title": "For Each",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For Each",
          "skip_execution": false,
          "source_array": "$workflow.definition_workflow_0212ZRNRD53XO29mwWAomqQngNGKccFQ32G.local.variable_workflow_0219CLA2359V16lldItAk8daiPPsrXthJXN$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_0219CPUQ9LGIZ2QmvaKi68XSkXRJxi9JuNK",
            "name": "HTTP Request",
            "title": "Create RM from Table",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "accept": "application/json",
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "{\n     \"query\": {\n          \"q\": \"$activity.definition_activity_0212ZX1LO33T22jMb5RuczKHoCXlNbQud6D.input.source_array[@].RM_Search_String$\"\n     },\n     \"name\": \"$activity.definition_activity_0212ZX1LO33T22jMb5RuczKHoCXlNbQud6D.input.source_array[@].RM_Name$\"\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "X-Risk-Token",
                  "value": "$workflow.definition_workflow_0212ZRNRD53XO29mwWAomqQngNGKccFQ32G.input.variable_workflow_0212ZUIZIRYWE78STEODVLdBO7jORSN6svc$"
                }
              ],
              "display_name": "Create RM from Table",
              "method": "POST",
              "relative_url": "/asset_groups",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "use_workflow_target": true
              },
              "user_agent": "SXO"
            },
            "object_type": "definition_activity"
          }
        ]
      }
    ],
    "categories": [
      "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r"
    ]
  },
  "categories": {
    "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r": {
      "unique_name": "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r",
      "name": "SecureX",
      "title": "SecureX",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "targets": {
    "definition_target_021A12HNH7QZ16uAiIvGO6FIZl16xDL2nbi": {
      "unique_name": "definition_target_021A12HNH7QZ16uAiIvGO6FIZl16xDL2nbi",
      "name": "Kenna US Labs API",
      "title": "Kenna US Labs API",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "disable_certificate_validation": true,
        "display_name": "Kenna US Labs API",
        "host": "api.labs.us.kennasecurity.com",
        "ignore_proxy": false,
        "no_runtime_user": true,
        "protocol": "https"
      }
    }
  },
  "table_types": {
    "tabletype_0219CKPYO1XYU0C4W6FJS4GmjI2w3X8fYQW": {
      "unique_name": "tabletype_0219CKPYO1XYU0C4W6FJS4GmjI2w3X8fYQW",
      "data_type": "datatype.tabletype",
      "display_name": "Kenna Risk Meters",
      "description": "Table to define Risk Meter name and search string",
      "columns": [
        {
          "name": "RM_Name",
          "title": "RiskMeterName",
          "type": "string"
        },
        {
          "name": "RM_Search_String",
          "title": "RiskMeterSearch",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  }
}